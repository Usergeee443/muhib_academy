<!-- Buy Course Form Section -->
<section id="kurs-sotib-olish" class="py-6 md:py-20">
    <div class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8">
        <div class="text-center mb-6 md:mb-12">
            <div class="relative inline-block">
                <h2 class="text-2xl md:text-4xl lg:text-6xl font-bold text-white mb-2 md:mb-4">
                    Darslarimizga qo'shilish
                </h2>
            </div>
            <p class="text-sm md:text-lg lg:text-xl text-white/80 mt-2 md:mt-6 px-4">
                Quyidagi formani to'ldiring va biz siz bilan Telegram orqali bog'lanamiz
            </p>

            <p class="text-xl md:text-4xl lg:text-6xl mt-2 md:mt-6 px-4 text-yellow-400 font-semibold">
                <span class="line-through opacity-70 mr-2">999.000 so'm</span>
                <span class="bg-yellow-500 text-black rounded px-2 py-0.5 mr-2 font-bold">-40%</span>
                <span>599.000 so'm</span>
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8">
            <!-- Contact Form -->
            <div class="bg-white/10 backdrop-blur-sm rounded-xl md:rounded-3xl shadow-lg md:shadow-xl p-4 md:p-8 lg:p-12 border border-white/20">
                
                <!-- Success Message (Hidden by default) -->
                <div id="successMessage" class="hidden mb-6 p-4 bg-green-500/20 border border-green-500/30 rounded-xl backdrop-blur-sm">
                    <div class="flex items-center space-x-3">
                        <svg class="w-6 h-6 text-green-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <div>
                            <h3 class="text-green-400 font-semibold text-lg">Rahmat! Qabul qilindi</h3>
                            <p class="text-green-300 text-sm">Tez orada biz siz bilan bog'lanamiz</p>
                        </div>
                    </div>
                </div>

                <form id="courseForm" class="space-y-3 md:space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6">
                        <div>
                            <label for="firstName" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Ism *</label>
                            <input type="text" id="firstName" name="firstName" required
                                class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                                placeholder="Ismingizni kiriting">
                        </div>
                        <div>
                            <label for="lastName" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Familiya *</label>
                            <input type="text" id="lastName" name="lastName" required
                                class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                                placeholder="Familiyangizni kiriting">
                        </div>
                    </div>

                    <div>
                        <label for="phone" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Telefon raqam *</label>
                        <input type="tel" id="phone" name="phone" required
                            class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                            placeholder="+998 90 123 45 67">
                    </div>

                    <div>
                        <label for="telegram" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Telegram username *</label>
                        <input type="text" id="telegram" name="telegram" required
                            class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                            placeholder="@username yoki telefon raqam">
                    </div>

                    <div>
                        <label for="courseType" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Darslik Tanlash</label>
                        <div class="bg-white/15 rounded-lg md:rounded-xl shadow-sm md:shadow-lg p-3 md:p-6 border border-white/20">
                            <select id="courseType" name="courseType" required
                                class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white">
                                <option value="" disabled selected>Darslik turini tanlang...</option>
                                <option value="online" class="text-gray-800">Online (Video-kurs va zoom shaklda.)</option>
                            </select>

                            <!-- Description Container -->
                            <div id="courseDescription" class="hidden mt-3 md:mt-6 p-3 md:p-4 bg-white/10 rounded-lg border-l-4 border-white/60">
                                <div class="flex items-start space-x-2 md:space-x-3">
                                    <div class="flex-shrink-0">
                                        <div class="w-6 md:w-8 h-6 md:h-8 bg-white/30 rounded-full flex items-center justify-center">
                                            <svg class="w-3 md:w-4 h-3 md:h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <h3 id="descriptionTitle" class="text-sm md:text-lg font-semibold text-white mb-2"></h3>
                                        <div id="descriptionContent" class="text-white/80 space-y-1 md:space-y-2 text-xs md:text-sm"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label for="quranLevel" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">
                            üìä Qur'on o'qish darajangiz *
                        </label>
                        <div class="bg-white/15 rounded-lg md:rounded-xl shadow-sm md:shadow-lg p-3 md:p-6 border border-white/20">
                            <select id="quranLevel" name="quranLevel" required
                                class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white">
                                <option value="" disabled selected>Darajangizni tanlang...</option>
                                <option value="1" class="text-gray-800">1Ô∏è‚É£ Bilmayman ‚Äì Arab harflarini ham tanimayman</option>
                                <option value="2" class="text-gray-800">2Ô∏è‚É£ Harflarni taniyman ‚Äì Harflarni bilaman, lekin ulab o'qiy olmayman</option>
                                <option value="3" class="text-gray-800">3Ô∏è‚É£ O'qiyman, qiynalaman ‚Äì So'zlarni ulayman, lekin suralarda ko'p adashaman</option>
                                <option value="4" class="text-gray-800">4Ô∏è‚É£ O'qiyman, xatolarim bor ‚Äì Suralarni o'qiyman, lekin tajvid va talaffuzda xato qilaman</option>
                                <option value="5" class="text-gray-800">5Ô∏è‚É£ To'g'ri o'qiy olaman ‚Äì Ustoz kerak, yod olish uchun</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label for="age" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Yosh *</label>
                        <input type="number" id="age" name="age" required min="5" max="100"
                            class="w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                            placeholder="Yoshingizni kiriting">
                    </div>

                    <div>
                        <label for="message" class="block text-xs md:text-sm font-bold text-white mb-1 md:mb-3">Qo'shimcha xabar (ixtiyoriy)</label>
                        <textarea id="message" name="message" rows="2"
                            class="md:rows-4 w-full px-3 md:px-4 py-2.5 md:py-4 border-2 border-white/30 rounded-lg md:rounded-xl focus:border-white focus:outline-none transition duration-300 text-sm md:text-lg bg-white/20 text-white placeholder-white/60"
                            placeholder="Maxsus talablar yoki savollaringiz bormi?"></textarea>
                    </div>

                    <button type="submit" id="submitBtn"
                        class="w-full bg-white/20 backdrop-blur-sm text-white py-3 md:py-5 px-4 md:px-8 rounded-lg md:rounded-xl font-bold text-sm md:text-xl shadow-lg md:shadow-xl hover:bg-white/30 hover:shadow-xl md:hover:shadow-2xl transform hover:-translate-y-1 md:hover:-translate-y-2 active:scale-95 transition duration-300 border border-white/40">
                        <span id="submitText">Darslarga qo'shilish</span>
                        <span id="loadingText" class="hidden">Yuborilmoqda...</span>
                    </button>
                </form>

                <div class="mt-4 md:mt-8 p-3 md:p-6 bg-white/10 rounded-lg md:rounded-2xl border border-white/30">
                    <div class="flex items-start">
                        <svg class="w-4 md:w-6 h-4 md:h-6 text-white mr-2 md:mr-3 mt-0.5 md:mt-1 flex-shrink-0"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                clip-rule="evenodd" />
                        </svg>
                        <div>
                            <p class="text-white font-semibold mb-1 text-xs md:text-base">Muhim ma'lumot:</p>
                            <p class="text-white/80 text-xs md:text-sm leading-relaxed">
                                Formani yuborganingizdan so'ng, bizning jamoamiz 24 soat ichida Telegram orqali siz
                                bilan bog'lanadi va kurs ro'yxatga olish hamda to'lov jarayonini yakunlaydi. Barcha
                                kurslar 1 yillik ta'lim rejasi asosida tashkil etilgan.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map Section -->
            <div class="bg-white/10 backdrop-blur-sm rounded-xl md:rounded-3xl shadow-lg md:shadow-xl border border-white/20 overflow-hidden">
                <div class="p-4 md:p-8 pb-0">
                    <div class="flex items-center mb-1 md:mb-2">
                        <svg class="w-5 md:w-6 h-5 md:h-6 text-white mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                                clip-rule="evenodd" />
                        </svg>
                        <h3 class="text-lg md:text-2xl font-bold text-white">Bizning Manzil</h3>
                    </div>
                    <p class="text-white/80 mb-3 md:mb-6 text-xs md:text-base">Ta'lim markazimizga tashrif buyuring</p>
                </div>

                <!-- Interactive Map -->
                <div class="h-40 md:h-96 bg-gradient-to-br from-white/10 to-white/5 relative overflow-hidden">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3004.123456789!2d28.7920000!3d41.1080000!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14caa7040068086b%3A0x4c9f2c9f2c9f2c9f!2sKuzey%20Yakas%C4%B1%2C%20Kayaba%C5%9F%C4%B1%2C%2034494%20Ba%C5%9Fak%C5%9Fehir%2F%C4%B0stanbul%2C%20Turkey!5e0!3m2!1sen!2s!4v1638360000000!5m2!1sen!2s"
                        width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade" class="rounded-b-xl md:rounded-b-3xl">
                    </iframe>

                    <!-- Overlay with contact info -->
                    <div class="absolute bottom-1 md:bottom-4 left-1 md:left-4 right-1 md:right-4 bg-white/95 backdrop-blur-sm rounded-md md:rounded-2xl p-2 md:p-4 shadow-md md:shadow-lg">
                        <div class="space-y-1 md:space-y-3">
                            <div class="flex items-center">
                                <svg class="w-3 md:w-5 h-3 md:h-5 text-[#00D084] mr-1 md:mr-3 flex-shrink-0"
                                    fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                                        clip-rule="evenodd" />
                                </svg>
                                <span class="text-xs md:text-sm font-medium text-gray-800">Kuzey Yakasi, Kayaba≈üƒ±, 34494 Ba≈üak≈üehir/ƒ∞stanbul</span>
                            </div>
                            <div class="flex items-center">
                                <svg class="w-3 md:w-5 h-3 md:h-5 text-[#00D084] mr-1 md:mr-3 flex-shrink-0"
                                    fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" />
                                </svg>
                                <span class="text-xs md:text-sm font-medium text-gray-800">+905397401555</span>
                            </div>
                            <div class="flex items-center">
                                <svg class="w-3 md:w-5 h-3 md:h-5 text-[#00D084] mr-1 md:mr-3 flex-shrink-0"
                                    fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                                </svg>
                                <span class="text-xs md:text-sm font-medium text-gray-800">info@muhibacademy.uz</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Info -->
                <div class="p-3 md:p-8 pt-3 md:pt-6">
                    <div class="grid grid-cols-2 gap-2 md:gap-4">
                        <div class="text-center p-3 md:p-4 bg-white/20 backdrop-blur-sm rounded-lg md:rounded-xl border border-white/30">
                            <div class="text-lg md:text-2xl font-bold text-white">24/7</div>
                            <div class="text-xs md:text-sm text-white/80">Online yordam</div>
                        </div>
                        <div class="text-center p-3 md:p-4 bg-white/20 backdrop-blur-sm rounded-lg md:rounded-xl border border-white/30">
                            <div class="text-lg md:text-2xl font-bold text-white">1000+</div>
                            <div class="text-xs md:text-sm text-white/80">Mamnun talabalar</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// Environment variables (should be loaded from .env in production)
const BOT_TOKEN = process.env.BOT_TOKEN || 'YOUR_BOT_TOKEN';
const CHAT_ID = process.env.CHAT_ID || 'YOUR_CHAT_ID';

const courseSelect = document.getElementById('courseType');
const descriptionContainer = document.getElementById('courseDescription');
const descriptionTitle = document.getElementById('descriptionTitle');
const descriptionContent = document.getElementById('descriptionContent');

// Course descriptions
const courseDescriptions = {
    online: {
        title: "Online Ta'lim Tafsilotlari",
        content: [
            "Barcha darslar onlayn formatda o'tiladi",
            "Video-kurslar va Zoom orqali jonli darslar",
            "Ustoz tomonidan muntazam testlar va nazorat",
            "Har qanday vaqt va joydan kirish imkoniyati",
            "Individual o'qish jarayonini kuzatish",
            "Interaktiv mashqlar va amaliy topshiriqlar",
            "Ustoz bilan to'g'ridan-to'g'ri muloqot",
            "O'quvchining rivojlanishini doimiy monitoring qilish"
        ]
    }
};

// Handle course selection change
courseSelect.addEventListener('change', function () {
    const selectedCourse = this.value;

    if (selectedCourse && courseDescriptions[selectedCourse]) {
        const description = courseDescriptions[selectedCourse];

        // Update title
        descriptionTitle.textContent = description.title;

        // Update content
        descriptionContent.innerHTML = description.content
            .map(item => `<div class="flex items-start space-x-2">
                <span class="text-primary font-medium">‚Ä¢</span>
                <span>${item}</span>
            </div>`)
            .join('');

        // Show description with animation
        descriptionContainer.classList.remove('hidden');
        descriptionContainer.classList.add('animate-fade-in');

        // Add smooth scroll to description
        setTimeout(() => {
            descriptionContainer.scrollIntoView({
                behavior: 'smooth',
                block: 'nearest'
            });
        }, 100);

    } else {
        // Hide description
        descriptionContainer.classList.add('hidden');
        descriptionContainer.classList.remove('animate-fade-in');
    }
});

// Handle form submission
document.getElementById('courseForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const loadingText = document.getElementById('loadingText');
    const successMessage = document.getElementById('successMessage');
    
    // Show loading state
    submitBtn.disabled = true;
    submitText.classList.add('hidden');
    loadingText.classList.remove('hidden');
    
    // Get form data
    const formData = new FormData(e.target);
    const data = {
        firstName: formData.get('firstName'),
        lastName: formData.get('lastName'),
        phone: formData.get('phone'),
        telegram: formData.get('telegram'),
        courseType: formData.get('courseType'),
        quranLevel: formData.get('quranLevel'),
        age: formData.get('age'),
        message: formData.get('message') || 'Qo\'shimcha xabar yo\'q'
    };
    
    // Get level text
    const levelTexts = {
        '1': '1Ô∏è‚É£ Bilmayman ‚Äì Arab harflarini ham tanimayman',
        '2': '2Ô∏è‚É£ Harflarni taniyman ‚Äì Harflarni bilaman, lekin ulab o\'qiy olmayman',
        '3': '3Ô∏è‚É£ O\'qiyman, qiynalaman ‚Äì So\'zlarni ulayman, lekin suralarda ko\'p adashaman',
        '4': '4Ô∏è‚É£ O\'qiyman, xatolarim bor ‚Äì Suralarni o\'qiyman, lekin tajvid va talaffuzda xato qilaman',
        '5': '5Ô∏è‚É£ To\'g\'ri o\'qiy olaman ‚Äì Ustoz kerak, yod olish uchun'
    };
    
    // Create message for Telegram
    const message = `
üéì YANGI RO'YXATGA OLISH

üë§ Ism-Familiya: ${data.firstName} ${data.lastName}
üì± Telefon: ${data.phone}
üí¨ Telegram: ${data.telegram}
üìö Kurs turi: ${data.courseType === 'online' ? 'Online' : data.courseType}
üìä Qur'on darajasi: ${levelTexts[data.quranLevel]}
üéÇ Yoshi: ${data.age}
üí≠ Qo'shimcha: ${data.message}

‚è∞ Vaqt: ${new Date().toLocaleString('uz-UZ', {timeZone: 'Asia/Tashkent'})}
    `;
    
    try {
        // Send to Telegram bot
        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: message,
                parse_mode: 'HTML'
            })
        });
        
        if (response.ok) {
            // Show success message
            successMessage.classList.remove('hidden');
            e.target.reset();
            
            // Hide description if shown
            descriptionContainer.classList.add('hidden');
            
            // Scroll to success message
            successMessage.scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
            
        } else {
            throw new Error('Telegram API error');
        }
        
    } catch (error) {
        console.error('Error sending message:', error);
        alert('Xatolik yuz berdi. Iltimos, qayta urinib ko\'ring yoki to\'g\'ridan-to\'g\'ri bog\'laning.');
    } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitText.classList.remove('hidden');
        loadingText.classList.add('hidden');
    }
});

// Animation styles
const style = document.createElement('style');
style.textContent = `
    .animate-fade-in {
        animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Mobile-specific optimizations */
    @media (max-width: 768px) {
        .grid {
            gap: 0.75rem;
        }

        input,
        select,
        textarea {
            font-size: 14px !important;
        }

        button {
            font-size: 14px !important;
            font-weight: 600 !important;
        }
    }
`;
document.head.appendChild(style);
</script>